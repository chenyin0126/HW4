$(".forms").addClass("mdl-shadow--2dp animated fadeInDown");$("#ck-button").children().addClass("mdl-shadow--2dp");$("#daily-button").children().not("span").addClass("mdl-shadow--2dp");$(".icon").addClass("mdl-shadow--2dp");$("#save").addClass("mdl-shadow--2dp");Parse.initialize("fQA6Nbiwo2gCK1EH9eOH3YwU0S96nLnM6rEjkjiW","p6LeZCW3qLA6OcH0Pkfhz714pAsZOdZFJd33aLpl");Parse.User.current().fetch();var currentUser=Parse.User.current();currentUser.fetch().then(function(b){var a=b.getUsername()});var redCross=' <span style="color: #F44336">&#10006;</span>';var err_p=document.createElement("P");err_p.style.textAlign="center";err_p.style.color="#333";err_p.id="err_p";var bool_showError=false;var days={sunday:false,monday:false,tuesday:false,wednesday:true,thursday:false,friday:false,saturday:false};var times;var img={name:"",url:"",__type:"File"};var default_img;getParseData(getQueryVariable("id"));$(document).ready(function(){$("#ck-button label input").change(function(a){days[this.value]=this.checked})});$(document).ready(function(){$("#daily-button label input").change(function(a){$("#others").val("");times=this.value})});$(document).ready(function(){$("#others").keyup(function(){$("#r1").attr("checked",false);$("#r2").attr("checked",false);$("#r3").attr("checked",false)});$("#others").change(function(){$("#r1").attr("checked",false);$("#r2").attr("checked",false);$("#r3").attr("checked",false)})});$("#icon4").click(function(){$("#uploader").trigger("click")});$("#uploader").change(function(){var c=$("#uploader").prop("files");if(c.length>0){var a=c[0].name;var b=c[0].type;$.ajax({url:"https://api.parse.com/1/files/"+a,type:"POST",headers:{"X-Parse-Application-Id":"fQA6Nbiwo2gCK1EH9eOH3YwU0S96nLnM6rEjkjiW","X-Parse-REST-API-Key":"O0AtJZe9VdbGnwBmSFb41yIRB2J6rKiXqa5kOI56"},dataType:"JSON",contentType:b,processData:false,data:c[0],success:function(e,d,f){$("#icon4").unbind("click");$("#icon4").attr("src",e.url);$("#icon4").attr("onclick","selectImage('icon4');");selectImage("icon4");img.name=e.name;img.url=e.url;analyticsUploadImage()},error:function(f,d,e){alert("error upload image");Rollbar.error("Error Upload Image:",f.responseText)}})}});function selectImage(a){document.getElementById("icon1").style.border="none";document.getElementById("icon2").style.border="none";document.getElementById("icon3").style.border="none";document.getElementById("icon4").style.border="none";var b=document.getElementById(a);b.style.border="5px solid #42A5F5";if(a!="icon4"){default_img="../img/"+a+".jpg"}else{default_img=undefined;icon.style.border="5px solid #42A5F5"}}function checkInputs(b){var a=document.getElementById("title").value;if(!a){showError("Habit title missing!")}else{b(a)}}function showError(a){bool_showError=true;err_p.innerHTML=a+redCross;document.getElementById("form").appendChild(err_p)}function OnClickSave(){checkInputs(function(b){var a={title:document.getElementById("title").value,days:days,times:times,other:document.getElementById("others").value,img:img,default_img:default_img};$.ajax({url:"https://api.parse.com/1/classes/Habits/"+getQueryVariable("id"),type:"PUT",dataType:"JSON",contentType:"application/json",headers:{"X-Parse-Application-Id":"fQA6Nbiwo2gCK1EH9eOH3YwU0S96nLnM6rEjkjiW","X-Parse-REST-API-Key":"O0AtJZe9VdbGnwBmSFb41yIRB2J6rKiXqa5kOI56"},data:JSON.stringify(a),success:function(d,c,e){alert("Success Update");analyticsEditHabit();window.location.href="../src/list.min.html"},error:function(e,c,d){alert("error update");Rollbar.error("Error Update:",e.responseText)}})})}function getQueryVariable(a){var c=window.location.search.substring(1);var d=c.split("&");for(var b=0;b<d.length;b++){var e=d[b].split("=");if(e[0]==a){return e[1]}}}function getParseData(a){$.ajax({url:"https://api.parse.com/1/classes/Habits/"+a,type:"GET",dataType:"JSON",contentType:"application/json",headers:{"X-Parse-Application-Id":"fQA6Nbiwo2gCK1EH9eOH3YwU0S96nLnM6rEjkjiW","X-Parse-REST-API-Key":"O0AtJZe9VdbGnwBmSFb41yIRB2J6rKiXqa5kOI56"},success:function(c,b,d){setupData(c)},error:function(d,b,c){alert("Error Get Parse Data");Rollbar.error("Error Get Parse Data:",d.responseText)}})}function setupData(a){$("#title").val(a.title);if(a.img.name){selectImage("icon4");$("#icon4").attr("src",a.img.url)}else{selectImage(a.default_img.split(".")[2].split("/")[2])}$("#ck-button input").each(function(){if(a.days[this.value]){this.setAttribute("checked","checked")}});$("#daily-button input").each(function(){var c=a.times;var b=a.other;if(b===null||b===""){switch(c){case"1":if(this.value=="1"){this.setAttribute("checked","checked")}break;case"2":if(this.value=="2"){this.setAttribute("checked","checked")}break;case"3":if(this.value=="3"){this.setAttribute("checked","checked")}break;default:break}}else{$("#others").val(b)}})}function analyticsEditHabit(){var a={};Parse.Analytics.track("Edit Habit",a)}function analyticsUploadImage(){var a={};Parse.Analytics.track("Uploaded Image",a)};