function shadowing(){$("#habit-list").children().addClass("mdl-shadow--2dp");$(".habit-icon").addClass("mdl-shadow--2dp")}$("#addHabit").addClass("mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect");$("h1").addClass("animated fadeInDown");var btn=$("<button/>").addClass("mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect");btn.attr("id","settingsButton");btn.attr("style","color: rgb(33, 72, 100)");btn.html("Settings");var div=$("<div/>").attr({id:"settingButtonDiv"});div.css("text-align","center");div.html(btn);$("body").append(div);$("#settingsButton").click(function(a){window.location.href="../src/settings.min.html"}).addClass("animated fadeInUp");Parse.initialize("fQA6Nbiwo2gCK1EH9eOH3YwU0S96nLnM6rEjkjiW","p6LeZCW3qLA6OcH0Pkfhz714pAsZOdZFJd33aLpl");Parse.User.current().fetch();var currentUserId=Parse.User.current().id;var g_notificationData;function onClickDone(a){var b=(a.parentNode.parentNode.getElementsByClassName("message"))[0];b.style.visibility="visible";var c=a.id.split("-")[2];var d={todayCount:findNotificationbyId(c,g_notificationData).todayCount+1};$.ajax({url:"https://api.parse.com/1/classes/Notifications/"+findNotificationbyId(c,g_notificationData).objectId,type:"PUT",dataType:"JSON",contentType:"application/json",headers:{"X-Parse-Application-Id":"fQA6Nbiwo2gCK1EH9eOH3YwU0S96nLnM6rEjkjiW","X-Parse-REST-API-Key":"O0AtJZe9VdbGnwBmSFb41yIRB2J6rKiXqa5kOI56"},data:JSON.stringify(d),success:function(f,e,g){findNotificationbyId(c,g_notificationData).todayCount+=1;$("#today-"+c).html(findNotificationbyId(c,g_notificationData).todayCount);analyticsHabitDone()},error:function(g,e,f){alert("Error Update");Rollbar.error("Error Update:",g.responseText)}})}function onClickDelete(b){var c=b.id.split("-")[2];var a=confirm("Want to delete?");if(a){$.ajax({url:"https://api.parse.com/1/classes/Habits/"+c,type:"DELETE",dataType:"JSON",contentType:"application/json",headers:{"X-Parse-Application-Id":"fQA6Nbiwo2gCK1EH9eOH3YwU0S96nLnM6rEjkjiW","X-Parse-REST-API-Key":"O0AtJZe9VdbGnwBmSFb41yIRB2J6rKiXqa5kOI56"},success:function(f,d,g){deleteNotification(c,g_notificationData);alert("success delete");analyticsHabitDelete();var h=b.parentNode.parentNode;var e=h.parentNode;$(h).addClass("animated fadeOutRight");setTimeout(function(){e.removeChild(h)},500)},error:function(f,d,e){alert("Error Delete");Rollbar.error("Error Delete:",f.responseText)}})}}function onClickEdit(a){analyticsHabitEdit();window.location.href="../src/edit.min.html?id="+a.id.replace("op-edit-","")}function onRowReady(c,k,h,b,j,m,e){console.log(c);var a=parseInt(m)/parseInt(e)*100;var l=$("#template").clone();l.attr("id",c);l.find(".snooze").attr("id","snooze-"+c);l.find(".ignore").attr("id","ignore-"+c);l.find(".goSetting").attr("id","goSetting-"+c);l.find(".habit-name").html(k);l.find(".habit-icon").attr("src",h);l.find("#days").html(m);l.find("#best").html(e);var g=document.createElement("div");g.id="progress-"+c;g.className="mdl-progress mdl-js-progress";g.addEventListener("mdl-componentupgraded",function(){this.MaterialProgress.setProgress(a)});componentHandler.upgradeElement(g);l.find(".message-total").append(g);l.find("#today").attr("id","today-"+c).html(j);l.find("#times").attr("id","times-"+c).html(b);l.find(".op-done").attr("id","op-done-"+c);l.find(".op-edit").attr("id","op-edit-"+c);l.find(".op-del").attr("id","op-del-"+c);l.appendTo("#habit-list");var d=document.createElement("div");d.className="menu";d.innerHTML='<button id="menu-button-'+c+'"class="mdl-button mdl-js-button mdl-button--icon" style="float: right; color: #888;"><i class="material-icons">more_vert</i></button><ul class="mdl-menu mdl-menu&#45;&#45;bottom-right mdl-js-menu mdl-js-ripple-effect" for="menu-button-'+c+'"><li class="mdl-menu__item snooze" id="snooze-'+c+'">Snooze for 15 minutes</li><li class="mdl-menu__item ignore" id="ignore-'+c+'">Ignore</li><li class="mdl-menu__item goSetting" id="goSetting">Go To Settings</li></ul>';var f=document.getElementById(c);f.insertBefore(d,f.firstChild);componentHandler.upgradeAllRegistered()}function addMenuListeners(){$(".snooze").on("click",function(){var a=$(this).attr("id").replace("snooze-","");alert("snooze "+a)});$(".ignore").on("click",function(){var a=$(this).attr("id").replace("ignore-","");alert("ignore "+a)});$(".goSetting").on("click",function(){})}function getParseData(){var b={userId:currentUserId};var a=encodeURIComponent(JSON.stringify(b));$.ajax({url:"https://api.parse.com/1/classes/Habits?where="+a,type:"GET",dataType:"JSON",contentType:"application/json",headers:{"X-Parse-Application-Id":"fQA6Nbiwo2gCK1EH9eOH3YwU0S96nLnM6rEjkjiW","X-Parse-REST-API-Key":"O0AtJZe9VdbGnwBmSFb41yIRB2J6rKiXqa5kOI56"},success:function(d,c,e){getNotificationData(currentUserId,function(f){g_notificationData=f;processJSONData(d,f)})},error:function(e,c,d){alert("Error Get Parse Data");Rollbar.error("Error Get Parse Data:",e.responseText)}})}function processJSONData(b,d){$.each(b.results,function(e,h){var f=$.map(d,function(k){if(k.habitId===h.objectId){return k.todayCount}});var g=$.map(d,function(k){if(k.habitId===h.objectId){return k.daysInRow}});var j=$.map(d,function(k){if(k.habitId===h.objectId){return k.best}});if(typeof h.default_img==="undefined"){onRowReady(h.objectId,h.title,h.img.url,h.times,f,g,j)}else{onRowReady(h.objectId,h.title,h.default_img,h.times,f,g,j)}});shadowing();addMenuListeners();if(b.results&&d){var c=d[0];var a=$.map(b.results,function(e){if(e.objectId===c.habitId){return e}});a=a[0];notifyMe("Review "+a.title,"You haven't done yet, click to view",a.objectId,function(f){window.location.hash="#"+f.target.tag;$("#menu-button-"+f.target.tag).trigger("click")},function(f){})}else{notifyMe("Add Your First Habit!","You don't have a habit yet, click to add","new",function(f){$("#addHabit").trigger("click")},function(f){})}}function findNotificationbyId(a,b){for(i=0;i<b.length;i++){if(b[i].habitId===a){return b[i]}}}function findNotificationbyId2(a,b){for(i=0;i<b.length;i++){if(b[i].habitId===a){return i}}}function deleteNotification(a,b){$.ajax({url:"https://api.parse.com/1/classes/Notifications/"+findNotificationbyId(a,b).objectId,type:"DELETE",dataType:"JSON",contentType:"application/json",headers:{"X-Parse-Application-Id":"fQA6Nbiwo2gCK1EH9eOH3YwU0S96nLnM6rEjkjiW","X-Parse-REST-API-Key":"O0AtJZe9VdbGnwBmSFb41yIRB2J6rKiXqa5kOI56"},success:function(d,c,e){b.splice(findNotificationbyId2(a,b),1)},error:function(e,c,d){Rollbar.error("Error Delete Notification:",e.responseText)}})}function analyticsHabitDone(){var a={};Parse.Analytics.track("Habit Done",a)}function analyticsHabitDelete(){var a={};Parse.Analytics.track("Habit Delete",a)}function analyticsHabitEdit(){var a={};Parse.Analytics.track("Habit Edit",a)};