$(".forms").addClass("mdl-shadow--2dp animated fadeInDown");$("#ck-button").children().addClass("mdl-shadow--2dp");$("#daily-button").children().not("span").addClass("mdl-shadow--2dp");$(".icon").addClass("mdl-shadow--2dp");$("#save").addClass("mdl-shadow--2dp");Parse.initialize("fQA6Nbiwo2gCK1EH9eOH3YwU0S96nLnM6rEjkjiW","p6LeZCW3qLA6OcH0Pkfhz714pAsZOdZFJd33aLpl");Parse.User.current().fetch();var currentUser=Parse.User.current();currentUser.fetch().then(function(b){var a=b.getUsername()});var redCross=' <span style="color: #F44336">&#10006;</span>';var err_p=document.createElement("P");err_p.style.textAlign="center";err_p.style.color="#333";err_p.id="err_p";var bool_showError=false;var days={sunday:false,monday:false,tuesday:false,wednesday:false,thursday:false,friday:false,saturday:false};var times;var img={name:"",url:"",__type:"File"};var default_img;$(document).ready(function(){$("#ck-button label input").change(function(a){days[this.value]=this.checked})});$(document).ready(function(){$("#daily-button label input").change(function(a){$("#others").val("");times=this.value})});$(document).ready(function(){$("#others").keyup(function(){$("#r1").attr("checked",false);$("#r2").attr("checked",false);$("#r3").attr("checked",false)});$("#others").change(function(){$("#r1").attr("checked",false);$("#r2").attr("checked",false);$("#r3").attr("checked",false)})});$("#icon4").click(function(){$("#uploader").trigger("click")});$("#uploader").change(function(){var c=$("#uploader").prop("files");if(c.length>0){var a=c[0].name;var b=c[0].type;$.ajax({url:"https://api.parse.com/1/files/"+a,type:"POST",headers:{"X-Parse-Application-Id":"fQA6Nbiwo2gCK1EH9eOH3YwU0S96nLnM6rEjkjiW","X-Parse-REST-API-Key":"O0AtJZe9VdbGnwBmSFb41yIRB2J6rKiXqa5kOI56"},dataType:"JSON",contentType:b,processData:false,data:c[0],success:function(e,d,f){$("#icon4").attr("src",e.url);selectImage("icon4");img.name=e.name;img.url=e.url;analyticsUploadImage()},error:function(f,d,e){alert("error upload image");Rollbar.error("Error Upload Image:",f.responseText)}})}});function onClickAdd(){checkInputs(function(c,a){var b={userId:Parse.User.current().id,title:c,days:days,times:times,other:a,img:img,default_img:default_img};$.ajax({url:"https://api.parse.com/1/classes/Habits",type:"POST",dataType:"JSON",contentType:"application/json",headers:{"X-Parse-Application-Id":"fQA6Nbiwo2gCK1EH9eOH3YwU0S96nLnM6rEjkjiW","X-Parse-REST-API-Key":"O0AtJZe9VdbGnwBmSFb41yIRB2J6rKiXqa5kOI56"},data:JSON.stringify(b),success:function(e,d,f){analyticsAddHabit();createNotify(Parse.User.current().id,e.objectId)},error:function(f,d,e){alert("Error Save "+f.responseText);Rollbar.error("Error Save New Habit:",f.responseText)}})})}function checkInputs(c){var b=document.getElementById("title").value;var a=document.getElementById("others").value;if(!b){showError("Habit title missing!")}else{if(typeof $(".icon").attr("style")==="undefined"){showError("Icon missing!")}else{if(!(days.sunday||days.monday||days.tuesday||days.wednesday||days.thursday||days.friday||days.saturday)){showError("Weekly frequency missing!")}else{if(!times){showError("Daily frequency missing!")}else{if(bool_showError){document.getElementById("form").removeChild(err_p)}c(b,a)}}}}}function showError(a){bool_showError=true;err_p.innerHTML=a+redCross;document.getElementById("form").appendChild(err_p)}function createNotify(a,b){var c={userId:a,habitId:b,todayCount:0,daysInRow:0,best:0};$.ajax({url:"https://api.parse.com/1/classes/Notifications",type:"POST",dataType:"JSON",contentType:"application/json",headers:{"X-Parse-Application-Id":"fQA6Nbiwo2gCK1EH9eOH3YwU0S96nLnM6rEjkjiW","X-Parse-REST-API-Key":"O0AtJZe9VdbGnwBmSFb41yIRB2J6rKiXqa5kOI56"},data:JSON.stringify(c),success:function(e,d,f){alert("Success Save");analyticsAddNotification();window.location.href="../src/list.min.html"},error:function(f,d,e){alert("Error Save "+f.responseText);Rollbar.error("Error Save New Habit:",f.responseText)}})}function analyticsAddHabit(){var a={};Parse.Analytics.track("Add Habit",a)}function analyticsAddNotification(){var a={};Parse.Analytics.track("Add Notification",a)}function analyticsUploadImage(){var a={};Parse.Analytics.track("Uploaded Image",a)}function selectImage(a){document.getElementById("icon1").style.border="none";document.getElementById("icon2").style.border="none";document.getElementById("icon3").style.border="none";document.getElementById("icon4").style.border="none";var b=document.getElementById(a);b.style.border="5px solid #42A5F5";if(a!="icon4"){default_img="../img/"+a+".jpg"}else{default_img=undefined}};